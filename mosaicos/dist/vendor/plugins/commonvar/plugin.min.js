/**
 * plugin.js
 *
 * Released under LGPL License.
 * Copyright (c) 1999-2015 Ephox Corp. All rights reserved
 *
 * License: http://www.tinymce.com/license
 * Contributing: http://www.tinymce.com/contributing
 */

/*global tinymce:true */

tinymce.PluginManager.add('commonvar', function(editor) {

    var var_menuItems = [], var_lastFormat, var_defaultButtonTimeFormat;


    function getVarDesc(key) {
        return sourse_formats[key];
    }

    function insertCommonvar(key) {
        editor.insertContent(key);
    }

    editor.addButton('commonvar', {
        type: 'splitbutton',
        text: '变量',
        title: '变量',
        onclick: function() {
            insertCommonvar(var_lastFormat || var_defaultButtonTimeFormat);
        },
        menu: var_menuItems
    });

    tinymce.each(var_sourse_keys, function(key) {
        if (!var_defaultButtonTimeFormat) {
            var_defaultButtonTimeFormat = key;
        }
        var_menuItems.push({
            text: getVarDesc(key),
            onclick: function() {
                var_lastFormat = key;
                insertCommonvar(key);
            }
        });
    });

    editor.addMenuItem('commonvar', {
        text: '变量',
        menu: var_menuItems,
        context: 'insert'
    });

});